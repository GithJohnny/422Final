<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>237992905a4e42ba8971d26c394faf88</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown" id="QgBMCqZDygyW">
#How to analyze and predict expected market prices of store products using Walmart catalog data.
<p>#####Paul Ng, Johnny Rajala, Julie Young</p>
</div>
<div class="cell code" data-execution_count="1" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="_H1aw0URmiH6" data-outputId="9fb49933-1fca-44d7-e6a9-5fc8afb3be56">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Necessary Imports</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> linear_model</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> regex <span class="im">as</span> re</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">&#39;/content/drive&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mounted at /content/drive
</code></pre>
</div>
</div>
<section id="importing-the-data" class="cell markdown" id="WoexoZ5fTULZ">
<h2>Importing the Data</h2>
</section>
<div class="cell markdown" id="0winMMMr5fUM">
<p>Features suchs URL, breadrumbs, and promotions don't have consistent categories or quantifiable values associate with them, so we will be dropping them for the sake of consistency.</p>
</div>
<div class="cell code" data-execution_count="2" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="IpAqc3APmiH8" data-outputId="6c212a89-808f-4ca2-e88a-2df48c55d121">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">&#39;/content/drive/My Drive/CMSC422_P3/WMT_Grocery_202209.csv&#39;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(path)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># All data collected at same time, SKU is not useful, promotion is empty, breadcrumbs encodes data from department and category. </span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop([<span class="st">&#39;index&#39;</span>,<span class="st">&#39;SKU&#39;</span>,<span class="st">&#39;RunDate&#39;</span>,<span class="st">&#39;PRODUCT_URL&#39;</span>,<span class="st">&#39;PROMOTION&#39;</span>,<span class="st">&#39;BREADCRUMBS&#39;</span>, <span class="st">&#39;tid&#39;</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.8/dist-packages/IPython/core/interactiveshell.py:3326: DtypeWarning: Columns (4) have mixed types.Specify dtype option on import or set low_memory=False.
  exec(code_obj, self.user_global_ns, self.user_ns)
</code></pre>
</div>
</div>
<section id="data-exploration" class="cell markdown" id="TeZ9ljS-TZ1a">
<h2>Data Exploration</h2>
</section>
<div class="cell code" data-execution_count="3" id="wOm2ROCKApIN">
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Used to turn on or off graphing functionality</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> <span class="va">True</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="4" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="UdN3uomRmiH9" data-outputId="95e0e039-d5c0-4f2e-c746-be2e9230d70a">
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data exploration</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> pd.unique(df[<span class="st">&#39;SHIPPING_LOCATION&#39;</span>])</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Unique Shipping Location: </span><span class="sc">{</span><span class="bu">len</span>(n)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> pd.unique(df[<span class="st">&#39;SUBCATEGORY&#39;</span>])</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Unique Subcategories: </span><span class="sc">{</span><span class="bu">len</span>(n)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> pd.unique(df[<span class="st">&#39;CATEGORY&#39;</span>])</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Unique Categories: </span><span class="sc">{</span><span class="bu">len</span>(n)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> pd.unique(df[<span class="st">&#39;PRODUCT_NAME&#39;</span>])</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Unique Product Names: </span><span class="sc">{</span><span class="bu">len</span>(n)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> pd.unique(df[<span class="st">&#39;BRAND&#39;</span>])</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Unique Brands: </span><span class="sc">{</span><span class="bu">len</span>(n)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>small <span class="op">=</span> df[df[<span class="st">&#39;PRICE_RETAIL&#39;</span>] <span class="op">!=</span> df[<span class="st">&#39;PRICE_CURRENT&#39;</span>]]</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Number of products on sale: </span><span class="sc">{</span><span class="bu">len</span>(n)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">&#39;PRODUCT_SIZE&#39;</span>].isnull().<span class="bu">sum</span>())</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> pd.unique(df[<span class="st">&#39;DEPARTMENT&#39;</span>])</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Number of departments: </span><span class="sc">{</span><span class="bu">len</span>(n)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd.unique(df[<span class="st">&#39;DEPARTMENT&#39;</span>]))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Unique Shipping Location: 26
Unique Subcategories: 126
Unique Categories: 114
Unique Product Names: 30688
Unique Brands: 4369
Number of products on sale: 4369
62825
Number of departments: 14
[&#39;Deli&#39; &#39;Beverages&#39; &#39;Baking&#39; &#39;Meat &amp; Seafood&#39; &#39;Candy&#39; &#39;Snacks&#39;
 &#39;Dairy &amp; Eggs&#39; &#39;Bakery &amp; Bread&#39; &#39;Breakfast &amp; Cereal&#39; &#39;Pantry&#39; &#39;Coffee&#39;
 &#39;Frozen&#39; &#39;Fresh Produce&#39; &#39;Alcohol&#39;]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="5" id="FiVli1FCwo2S">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># getting a sense for what the data table looks like</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df.head()</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop duplicate rows</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop_duplicates()</span></code></pre></div>
</div>
<div class="cell markdown" id="s-6dQx73miH_">
<p>Approximately 36% of the rows don't have a subcategory. There are 126 subcategories in total. 26 unique shipping locations. 114 unique categories. 11,795 items are on sale. 11% don't have a product size. 14 departments.</p>
</div>
<section id="descriptive-graphs" class="cell markdown" id="8AImKf0kThbv">
<h3>Descriptive Graphs</h3>
</section>
<div class="cell code" data-execution_count="6" data-colab="{&quot;height&quot;:281,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="wRJzF1eKmiIA" data-outputId="bc2d2ebd-7552-4043-c226-668378b5a06a">
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&#39;PRICE_CURRENT&#39;</span>].plot(kind<span class="op">=</span><span class="st">&#39;hist&#39;</span>,logy<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&#39;Price vs Frequency (Log)&#39;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/056dc5ee338e11077f2d1c056154af57f5b86a8a.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="7" data-colab="{&quot;height&quot;:367,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="ALIXY5Oqs4PX" data-outputId="1b39fa30-1448-4ca4-86c3-2a1908eb7c86">
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot using pastel colors</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sorted by retail price ascending </span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="fl">7.5</span>, <span class="fl">5.5</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    sns.histplot(data<span class="op">=</span>df.sort_values(<span class="st">&quot;PRICE_RETAIL&quot;</span>), x<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, hue<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, palette<span class="op">=</span><span class="st">&quot;pastel&quot;</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    frame1 <span class="op">=</span> plt.gca()</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    plt.setp(frame1.get_legend().get_title(), fontsize<span class="op">=</span><span class="st">&#39;10&#39;</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    plt.setp(frame1.get_legend().get_texts(), fontsize<span class="op">=</span><span class="st">&#39;9&#39;</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    frame1.axes.xaxis.set_ticklabels([])</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&quot;Department&quot;</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Frequency by Department Sorted by Retail Price&quot;</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/f9d1ce94ca8e2d2399a0e9452a1a4c1499e97e8e.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="8" data-colab="{&quot;height&quot;:549,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="6RvnYdV0HxD6" data-outputId="7a9b7ee7-97e1-45ca-d18c-b3ee70b68fcb">
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot using pastel colors</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sorted by retail price ascending </span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">24</span>, <span class="dv">6</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    sns.histplot(data<span class="op">=</span>df.sort_values(<span class="st">&quot;PRICE_RETAIL&quot;</span>), x<span class="op">=</span><span class="st">&quot;CATEGORY&quot;</span>, hue<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, palette<span class="op">=</span><span class="st">&quot;pastel&quot;</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    frame1 <span class="op">=</span> plt.gca()</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    plt.setp(frame1.get_legend().get_title(), fontsize<span class="op">=</span><span class="st">&#39;10&#39;</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    plt.setp(frame1.get_legend().get_texts(), fontsize<span class="op">=</span><span class="st">&#39;9&#39;</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    frame1.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&quot;Category&quot;</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Frequency by Category Sorted by Retail Price&quot;</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/acd31e9c13005b0fe08c6161caf02fa62358694f.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="9" data-colab="{&quot;height&quot;:365,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="z0ZpWJjlmiIB" data-outputId="c1b34f0e-c051-467d-8344-317ea9f16024">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the number of items in each department</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> df[<span class="st">&#39;BRAND&#39;</span>].value_counts()</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&#39;DEPARTMENT&#39;</span>].value_counts().plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&#39;Frequency by Department&#39;</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/f07059ed4e2d5b80fdd7ec7cd4c5a277a57215c8.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="10" data-colab="{&quot;height&quot;:549,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="7IUMmk0UxLp7" data-outputId="576e1054-5e7b-4d85-f2bc-7f51a0890552">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># looking at deviation before calculating residual</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">24</span>, <span class="dv">6</span>))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    sns.histplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">&quot;CATEGORY&quot;</span>, hue<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, palette<span class="op">=</span><span class="st">&quot;mako&quot;</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    frame1 <span class="op">=</span> plt.gca()</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    plt.setp(frame1.get_legend().get_title(), fontsize<span class="op">=</span><span class="st">&#39;10&#39;</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    plt.setp(frame1.get_legend().get_texts(), fontsize<span class="op">=</span><span class="st">&#39;9&#39;</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    frame1.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#frame1.axes.xaxis.set_ticklabels([])</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plt.xlabel(&quot;Department&quot;)</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Category Counts&quot;</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/568358121875a202286893c75e7e77280972b252.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="11" data-colab="{&quot;height&quot;:1000,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="8oWzGi280Obj" data-outputId="e98f76b8-6df9-454c-c490-b78138e8d5cc">
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># getting plots by department</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>departments <span class="op">=</span> df[<span class="st">&quot;DEPARTMENT&quot;</span>].unique()</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> d <span class="kw">in</span> departments:</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    sns.violinplot(data<span class="op">=</span>df[df[<span class="st">&quot;DEPARTMENT&quot;</span>] <span class="op">==</span> d], x <span class="op">=</span> <span class="st">&quot;CATEGORY&quot;</span>, y <span class="op">=</span> <span class="st">&quot;PRICE_RETAIL&quot;</span>, hue<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, palette<span class="op">=</span><span class="st">&quot;rocket&quot;</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    frame1 <span class="op">=</span> plt.gca()</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    frame1.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Retail Price by Category&quot;</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/9d16b131b3068f4abf82c0a121f09aa3562feb15.png" /></p>
</div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/28659b7eb8078fdeb41225ac9bef3bb397c4f5ca.png" /></p>
</div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/c59be2781d102ae729b7e718408b9c99227f3a9e.png" /></p>
</div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/d623c2f37839bac1cc97905d3a0d8fd3a15b6149.png" /></p>
</div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/1cf1646b10dc511eb96d28dcd89c80c09afd3619.png" /></p>
</div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/39afac034fe694681c23d199b548583ce47ef402.png" /></p>
</div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/696e53dbc95091f3b464cc967ac1cc48f8399e17.png" /></p>
</div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/06d0a269936fa31a109b6d48a1c7035a4122150b.png" /></p>
</div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/a26deaeb2535bd0b175fe9dcd278da17cdc9f238.png" /></p>
</div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/98699be676b4a6b4ca2bea7e6879d9d67dc77236.png" /></p>
</div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/91517893c56b4f0528aa2c5f251fe176efc0f49d.png" /></p>
</div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/e0d5ca410de1a093cb2892ae1b45ea5153662171.png" /></p>
</div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/a14c6b6f8bcafed375f406e0422b74b19c9ad162.png" /></p>
</div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/79829a2c208938e47f76ef1a6aecbd8497919a5f.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="12" data-colab="{&quot;height&quot;:433,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="cVun7D2KSCPQ" data-outputId="35b577cd-4177-42b3-cea2-82c82f6a4930">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting residual price by department</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;PRICE_RESIDUAL&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;PRICE_RETAIL&quot;</span>] <span class="op">-</span> df[<span class="st">&quot;PRICE_CURRENT&quot;</span>]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    sns.scatterplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, y<span class="op">=</span><span class="st">&quot;PRICE_RESIDUAL&quot;</span>, color<span class="op">=</span><span class="st">&quot;teal&quot;</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    frame1 <span class="op">=</span> plt.gca()</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    frame1.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Residual Price by Department&quot;</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/add8a24e5504e400cebdc36fe9e8f4c74bde3959.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="13" id="wqtAGGpMZ5cb">
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reinterpereting location values into the coordinates they represent, this must be done manually with current dataset</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Colab uses Python 3.8, so I cannot use match statements for this</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 79936, 48180, 96797, 94565, 23223, 75211, </span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 89108, 15601, 23111, 33012, 72034, 60007, </span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 63376, 44035, 53215, 33647, 6010, 66062, </span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 90650, 78130, 85225, 75052, 70072, 77449, </span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 30044, 45011])</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> getCoords(loc):</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 79936, 48180, 96797, 94565, 23223, 75211, </span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> loc <span class="op">==</span> <span class="dv">79936</span>:</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">31.756790</span>, <span class="op">-</span><span class="fl">106.270700</span> <span class="co"># El Paso, TX</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">48180</span>:</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">42.253080</span>, <span class="op">-</span><span class="fl">83.269870</span> <span class="co"># Taylor, MI</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">96797</span>:</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">21.390699</span>, <span class="op">-</span><span class="fl">158.033813</span> <span class="co"># Waipahu, Hawaii</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">94565</span>:</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">38.009048</span>, <span class="op">-</span><span class="fl">121.868141</span> <span class="co"># Pittsburgh, CA</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">23223</span>:</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">37.545799</span>, <span class="op">-</span><span class="fl">77.364601</span> <span class="co"># Richmond, VA</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">75211</span>:</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">32.753555</span>, <span class="op">-</span><span class="fl">96.975062</span> <span class="co"># Dallas, TX</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 89108, 15601, 23111, 33012, 72034, 60007, </span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">89108</span>:</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">36.215743</span>, <span class="op">-</span><span class="fl">115.244092</span> <span class="co"># Las Vegas</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">15601</span>:</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">40.3086219</span>, <span class="op">-</span><span class="fl">79.5802294</span> <span class="co"># Greensburg, PA</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">23111</span>:</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">37.6138602</span>, <span class="op">-</span><span class="fl">77.3555484</span> <span class="co"># Mechanicsville, VA</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">33012</span>:</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">25.935789</span>, <span class="op">-</span><span class="fl">80.29576</span> <span class="co"># Hialeah, FL </span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">72034</span>:</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">38.9826132</span>, <span class="op">-</span><span class="fl">76.94302457</span> <span class="co"># Conway, AR</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">60007</span>:</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">42.0017458</span>, <span class="op">-</span><span class="fl">106.270700</span> <span class="co"># Elk Grove IL</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 63376, 44035, 53215, 33647, 6010, 66062, </span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">63376</span>:</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">38.7449457</span>, <span class="op">-</span><span class="fl">90.588537</span> <span class="co"># St. Peters, MO</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">44035</span>:</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">41.3508768</span>, <span class="op">-</span><span class="fl">82.0672824</span> <span class="co"># Elyria, OH</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">53215</span>:</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">42.9839068</span>, <span class="op">-</span><span class="fl">87.9511923</span> <span class="co"># Milwaukee, WI</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">33647</span>:</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">28.283379</span>, <span class="op">-</span><span class="fl">82.718396</span> <span class="co"># Tampa, Florida</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">6010</span>:</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">38.9620325</span>, <span class="op">-</span><span class="fl">77.0273083</span> <span class="co"># DC</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">66062</span>:</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">38.8808731</span>, <span class="op">-</span><span class="fl">94.758123</span> <span class="co"># Olathe, KS</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a><span class="co"># 90650, 78130, 85225, 75052, 70072, 77449, </span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">90650</span>:</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">33.9183</span>, <span class="op">-</span><span class="fl">118.0829</span> <span class="co"># Norwalk, CA</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">78130</span>:</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">29.683731</span>, <span class="op">-</span><span class="fl">98.127919</span> <span class="co"># New Braunfels, TX</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">85225</span>:</span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">33.3378499</span>, <span class="op">-</span><span class="fl">111.854031</span> <span class="co"># cahndler, AZ</span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">75052</span>:</span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">32.6735323</span> ,<span class="op">-</span><span class="fl">97.0362342</span> <span class="co"># Grandprarie Texas</span></span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">70072</span>:</span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">29.87864</span>, <span class="op">-</span><span class="fl">90.093306</span> <span class="co"># Marrero, LA</span></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">77449</span>:</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">29.81874</span>, <span class="op">-</span><span class="fl">95.76758</span> <span class="co"># Katy Texas</span></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a><span class="co"># 30044, 45011])</span></span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">30044</span>:</span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">33.9367484</span>, <span class="op">-</span><span class="fl">84.0252455</span> <span class="co"># Lawrenceville, GA</span></span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span> loc <span class="op">==</span> <span class="dv">45011</span>:</span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">39.3881444</span>, <span class="op">-</span><span class="fl">84.508184</span> <span class="co"># Hamilton, OH       </span></span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">38.9869</span>, <span class="op">-</span><span class="fl">76.9426</span> <span class="co"># UMD</span></span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;LONGITUDE&#39;</span>], df[<span class="st">&#39;LATITUDE&#39;</span>] <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>df[<span class="st">&#39;SHIPPING_LOCATION&#39;</span>].<span class="bu">map</span>(getCoords))</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="14" data-colab="{&quot;height&quot;:337,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="BVuw59yT7pBT" data-outputId="c4e6d01c-9757-40a5-d63b-e20fccd05a07">
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="14">

  <div id="df-3c59008f-dadf-4dd7-9799-8ae01dd9837c">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SHIPPING_LOCATION</th>
      <th>DEPARTMENT</th>
      <th>CATEGORY</th>
      <th>SUBCATEGORY</th>
      <th>PRODUCT_NAME</th>
      <th>BRAND</th>
      <th>PRICE_RETAIL</th>
      <th>PRICE_CURRENT</th>
      <th>PRODUCT_SIZE</th>
      <th>PRICE_RESIDUAL</th>
      <th>LONGITUDE</th>
      <th>LATITUDE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Marketside Roasted Red Pepper Hummus, 10 Oz</td>
      <td>Marketside</td>
      <td>2.67</td>
      <td>2.67</td>
      <td>10</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
    </tr>
    <tr>
      <th>1</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Marketside Roasted Garlic Hummus, 10 Oz</td>
      <td>Marketside</td>
      <td>2.67</td>
      <td>2.67</td>
      <td>10</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
    </tr>
    <tr>
      <th>2</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Marketside Classic Hummus, 10 Oz</td>
      <td>Marketside</td>
      <td>2.67</td>
      <td>2.67</td>
      <td>10</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
    </tr>
    <tr>
      <th>3</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Marketside Everything Hummus, 10 oz</td>
      <td>Marketside</td>
      <td>2.67</td>
      <td>2.67</td>
      <td>10</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
    </tr>
    <tr>
      <th>4</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Price's Jalapeno Dip, 12 Oz.</td>
      <td>Price's</td>
      <td>3.12</td>
      <td>3.12</td>
      <td>12</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-3c59008f-dadf-4dd7-9799-8ae01dd9837c')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-3c59008f-dadf-4dd7-9799-8ae01dd9837c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-3c59008f-dadf-4dd7-9799-8ae01dd9837c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<section id="ols-ridge-regression" class="cell markdown" id="AM3yEZ4cTz2q">
<h1>OLS Ridge Regression</h1>
</section>
<section id="train-model" class="cell markdown" id="Bk3-cL8gXZPi">
<h3>Train model</h3>
</section>
<div class="cell code" data-execution_count="15" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="BSFygc5TTGtI" data-outputId="8b30c73d-d8b5-4ad6-945a-ab1d1db851f4">
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trying ridge regression model </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;PRODUCT_SIZE&quot;</span>] <span class="op">=</span> pd.to_numeric(df[<span class="st">&quot;PRODUCT_SIZE&quot;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>).fillna(<span class="dv">1</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>dummies <span class="op">=</span> pd.get_dummies(df , columns<span class="op">=</span>[<span class="st">&quot;CATEGORY&quot;</span>,<span class="st">&quot;DEPARTMENT&quot;</span>]) <span class="co"># one-hot-encoding major cols </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>dummies <span class="op">=</span> dummies.drop([<span class="st">&quot;SUBCATEGORY&quot;</span>, <span class="st">&quot;PRODUCT_NAME&quot;</span>, <span class="st">&quot;BRAND&quot;</span>, <span class="st">&quot;PRICE_CURRENT&quot;</span>, <span class="st">&quot;PRICE_RESIDUAL&quot;</span>], axis <span class="op">=</span> <span class="dv">1</span>) <span class="co"># dropping non-numerical cols</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Copy of data for later use</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>data_copy <span class="op">=</span> dummies.copy()</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>y_copy <span class="op">=</span> df[<span class="st">&#39;PRICE_CURRENT&#39;</span>]</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># the following is just an example to test ridge regression</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>reg <span class="op">=</span> linear_model.Ridge(alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>reg.fit(dummies, df[<span class="st">&quot;PRICE_CURRENT&quot;</span>]) <span class="co"># training using entire dataset</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>reg.score(dummies, df[<span class="st">&quot;PRICE_CURRENT&quot;</span>]) <span class="co"># testing accuracy using entire dataset</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="15">
<pre><code>0.9798181785235021</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="16" data-colab="{&quot;height&quot;:337,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="9g_UsjdLKgXp" data-outputId="8d50dba9-e435-49d2-8240-53fb9c7084a4">
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;PREDICTION&quot;</span>] <span class="op">=</span> reg.predict(dummies)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="16">

  <div id="df-7fad801f-ba2d-44a8-b154-50d1cf9c902b">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SHIPPING_LOCATION</th>
      <th>DEPARTMENT</th>
      <th>CATEGORY</th>
      <th>SUBCATEGORY</th>
      <th>PRODUCT_NAME</th>
      <th>BRAND</th>
      <th>PRICE_RETAIL</th>
      <th>PRICE_CURRENT</th>
      <th>PRODUCT_SIZE</th>
      <th>PRICE_RESIDUAL</th>
      <th>LONGITUDE</th>
      <th>LATITUDE</th>
      <th>PREDICTION</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Marketside Roasted Red Pepper Hummus, 10 Oz</td>
      <td>Marketside</td>
      <td>2.67</td>
      <td>2.67</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>2.719601</td>
    </tr>
    <tr>
      <th>1</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Marketside Roasted Garlic Hummus, 10 Oz</td>
      <td>Marketside</td>
      <td>2.67</td>
      <td>2.67</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>2.719601</td>
    </tr>
    <tr>
      <th>2</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Marketside Classic Hummus, 10 Oz</td>
      <td>Marketside</td>
      <td>2.67</td>
      <td>2.67</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>2.719601</td>
    </tr>
    <tr>
      <th>3</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Marketside Everything Hummus, 10 oz</td>
      <td>Marketside</td>
      <td>2.67</td>
      <td>2.67</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>2.719601</td>
    </tr>
    <tr>
      <th>4</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Price's Jalapeno Dip, 12 Oz.</td>
      <td>Price's</td>
      <td>3.12</td>
      <td>3.12</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>3.153056</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7fad801f-ba2d-44a8-b154-50d1cf9c902b')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-7fad801f-ba2d-44a8-b154-50d1cf9c902b button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-7fad801f-ba2d-44a8-b154-50d1cf9c902b');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<section id="graphing-residuals-along-various-features" class="cell markdown" id="PJAX_5EjZDsP">
<h3>Graphing residuals along various features</h3>
</section>
<div class="cell code" data-execution_count="17" data-colab="{&quot;height&quot;:433,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="RainOPAJCZNV" data-outputId="2aced72a-ca2a-4f43-f5e7-72cdbcd70345">
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot difference between current price and predicted price</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">5</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    sns.violinplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, y<span class="op">=</span>(df[<span class="st">&quot;PRICE_CURRENT&quot;</span>] <span class="op">-</span> df[<span class="st">&quot;PREDICTION&quot;</span>]),<span class="op">\</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                hue<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, palette<span class="op">=</span><span class="st">&quot;mako&quot;</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    frame1 <span class="op">=</span> plt.gca()</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    frame1.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    plt.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Residual Price (Current vs Predicted) by Department (Ridge)&quot;</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/adeb40c6156bc373191d19c3eab7e49163990258.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="18" data-colab="{&quot;height&quot;:424,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="t12J2ZstTmwN" data-outputId="201d4188-9b60-42de-d419-20305174749a">
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>funky <span class="op">=</span> df[df[<span class="st">&quot;CATEGORY&quot;</span>] <span class="op">==</span> <span class="st">&quot;Frozen Breakfast&quot;</span>]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>funky <span class="op">=</span> funky.sort_values(<span class="st">&quot;PRICE_CURRENT&quot;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>funky.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="18">

  <div id="df-c5babf25-af89-4c5b-a4a3-e03bcdc14b84">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SHIPPING_LOCATION</th>
      <th>DEPARTMENT</th>
      <th>CATEGORY</th>
      <th>SUBCATEGORY</th>
      <th>PRODUCT_NAME</th>
      <th>BRAND</th>
      <th>PRICE_RETAIL</th>
      <th>PRICE_CURRENT</th>
      <th>PRODUCT_SIZE</th>
      <th>PRICE_RESIDUAL</th>
      <th>LONGITUDE</th>
      <th>LATITUDE</th>
      <th>PREDICTION</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>406611</th>
      <td>33647</td>
      <td>Frozen</td>
      <td>Frozen Breakfast</td>
      <td>Shop all</td>
      <td>Tina's Cantina Breakfast Sausage 4oz</td>
      <td>Tina's</td>
      <td>1.14</td>
      <td>1.14</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>28.283379</td>
      <td>-82.718396</td>
      <td>1.255460</td>
    </tr>
    <tr>
      <th>518757</th>
      <td>66062</td>
      <td>Frozen</td>
      <td>Frozen Breakfast</td>
      <td>Shop all</td>
      <td>Tina's Cantina Breakfast Sausage 4oz</td>
      <td>Tina's</td>
      <td>1.14</td>
      <td>1.14</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>38.880873</td>
      <td>-94.758123</td>
      <td>1.254555</td>
    </tr>
    <tr>
      <th>402335</th>
      <td>23111</td>
      <td>Breakfast &amp; Cereal</td>
      <td>Frozen Breakfast</td>
      <td>Shop All</td>
      <td>Tina's Cantina Breakfast Sausage 4oz</td>
      <td>Tina's</td>
      <td>1.14</td>
      <td>1.14</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>37.613860</td>
      <td>-77.355548</td>
      <td>1.254005</td>
    </tr>
    <tr>
      <th>479171</th>
      <td>89108</td>
      <td>Frozen</td>
      <td>Frozen Breakfast</td>
      <td>Shop all</td>
      <td>Tina's Cantina Breakfast Sausage 4oz</td>
      <td>Tina's</td>
      <td>1.14</td>
      <td>1.14</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>36.215743</td>
      <td>-115.244092</td>
      <td>1.257968</td>
    </tr>
    <tr>
      <th>465109</th>
      <td>45011</td>
      <td>Breakfast &amp; Cereal</td>
      <td>Frozen Breakfast</td>
      <td>Shop All</td>
      <td>Tina's Cantina Breakfast Sausage 4oz</td>
      <td>Tina's</td>
      <td>1.14</td>
      <td>1.14</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>39.388144</td>
      <td>-84.508184</td>
      <td>1.253637</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c5babf25-af89-4c5b-a4a3-e03bcdc14b84')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-c5babf25-af89-4c5b-a4a3-e03bcdc14b84 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-c5babf25-af89-4c5b-a4a3-e03bcdc14b84');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="19" data-colab="{&quot;height&quot;:549,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="M96Fcl7EPvzS" data-outputId="8276f103-fcdd-46ec-c728-34830c193ef5">
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph residuals by category</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph: </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">24</span>, <span class="dv">6</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    sns.violinplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">&quot;CATEGORY&quot;</span>, y<span class="op">=</span>(df[<span class="st">&quot;PRICE_CURRENT&quot;</span>] <span class="op">-</span> df[<span class="st">&quot;PREDICTION&quot;</span>]),<span class="op">\</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                hue<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, palette<span class="op">=</span><span class="st">&quot;mako&quot;</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    frame1 <span class="op">=</span> plt.gca()</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    frame1.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    plt.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Residual Price (Current vs Predicted) by Category&quot;</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/1f9891639f059e18c427a82342efc5fc45d4579c.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="20" data-colab="{&quot;height&quot;:459,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="lruPdnCPIWqu" data-outputId="633bed4c-0154-47dd-a5ef-f3c7fe84461b">
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting retail price vs current price</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">7</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    sns.scatterplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">&quot;PRICE_CURRENT&quot;</span>, y<span class="op">=</span><span class="st">&quot;PRICE_RETAIL&quot;</span>, hue<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, palette<span class="op">=</span><span class="st">&quot;mako&quot;</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Current Price vs Retail Price&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/841dbd8e1da7f65e6cf8db954acaa6bc5bbfd1b1.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="21" data-colab="{&quot;height&quot;:459,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="3zGbqkFQ8-EG" data-outputId="d20b2880-be43-4a3d-8857-a42eee8665ac">
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting predicted price vs current price</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">7</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    sns.scatterplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">&quot;PRICE_CURRENT&quot;</span>, y<span class="op">=</span><span class="st">&quot;PREDICTION&quot;</span>, hue<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, palette<span class="op">=</span><span class="st">&quot;mako&quot;</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Predicted Price vs Current Price&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/ae39e3b373073c5c2279ba74e81748f0a1d0d6ec.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="22" data-colab="{&quot;height&quot;:459,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="HROduhkZ9bC5" data-outputId="6b0a4515-a507-4237-ae6f-162965d4548c">
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting predicted price vs current price</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">7</span>))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    sns.scatterplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">&quot;PRICE_RESIDUAL&quot;</span>, y<span class="op">=</span>(df[<span class="st">&quot;PREDICTION&quot;</span>] <span class="op">-</span> df[<span class="st">&quot;PRICE_CURRENT&quot;</span>]), hue<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, palette<span class="op">=</span><span class="st">&quot;mako&quot;</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Actual Residual vs Predicted Residual&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/1afd5f11f404f07e10184e17fbaff383086f495f.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="23" data-colab="{&quot;height&quot;:542,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="52HodbW-_na3" data-outputId="bcb6bbf6-b686-4a8a-c1dd-de92ccd4720d">
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting retail price by dept </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">7</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    sns.scatterplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, y<span class="op">=</span><span class="st">&quot;PRICE_CURRENT&quot;</span>, hue<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, palette<span class="op">=</span><span class="st">&quot;mako&quot;</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Current Price By Department&quot;</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    frame1 <span class="op">=</span> plt.gca()</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    frame1.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    plt.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/fb68ebf451525bb216b51a99da70c0d60846c0ce.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="24" data-colab="{&quot;height&quot;:542,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="IIPRAj5KCrtP" data-outputId="a89b0968-d62b-4d91-c97e-a64ef8aacc4f">
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting predicted price by detp</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">7</span>))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    sns.scatterplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, y<span class="op">=</span><span class="st">&quot;PREDICTION&quot;</span>, hue<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, palette<span class="op">=</span><span class="st">&quot;mako&quot;</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Predicted Price By Department (Ridge)&quot;</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    frame1 <span class="op">=</span> plt.gca()</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    frame1.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    plt.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/92a32c2bf5bc2aa42a2a54a65bc9afbdf491256a.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="25" data-colab="{&quot;height&quot;:515,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="NwVyR8WQlNxa" data-outputId="69682a1f-15e5-477d-ad7a-41c39cda60cd">
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#bar chart of 10 largest coefficients</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  plt.figure(figsize<span class="op">=</span>(<span class="dv">50</span>, <span class="dv">8</span>))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  zipper <span class="op">=</span> pd.DataFrame(columns <span class="op">=</span> [<span class="st">&#39;Feature&#39;</span>,<span class="st">&#39;Coefficient&#39;</span>], data <span class="op">=</span> <span class="bu">zip</span>(dummies.columns, reg.coef_))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  zipper[<span class="st">&#39;abs&#39;</span>] <span class="op">=</span> <span class="bu">abs</span>(zipper[<span class="st">&#39;Coefficient&#39;</span>])</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  zipper <span class="op">=</span> zipper.set_index(<span class="st">&#39;Feature&#39;</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  sortZip <span class="op">=</span> zipper.sort_values(<span class="st">&#39;abs&#39;</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  smallZip <span class="op">=</span> sortZip.head(<span class="dv">10</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  smallZip <span class="op">=</span> smallZip.drop([<span class="st">&#39;abs&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  smallZip.plot.bar()</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  frame1 <span class="op">=</span> plt.gca()</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  frame1.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  plt.title(<span class="st">&quot;Most important Features&quot;</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  plt.show()</span></code></pre></div>
<div class="output display_data">
<pre><code>&lt;Figure size 3600x576 with 0 Axes&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/373dfbfc0d2e6ea8cb2b3ba3cd93acf3544913a9.png" /></p>
</div>
</div>
<section id="investigating-outliers" class="cell markdown" id="qL1YyHTXZKT7">
<h3>Investigating Outliers</h3>
</section>
<div class="cell code" data-execution_count="26" data-colab="{&quot;height&quot;:406,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="J-hZWslsP3cI" data-outputId="9b93bedb-3ddf-4941-845b-2844e1e69494">
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>price_sort <span class="op">=</span> df.sort_values(<span class="st">&quot;PRICE_CURRENT&quot;</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>price_sort.tail() <span class="co"># finding the very high price</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="26">

  <div id="df-19c1b3ae-cb40-4f31-b7c9-870c9ace18ef">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SHIPPING_LOCATION</th>
      <th>DEPARTMENT</th>
      <th>CATEGORY</th>
      <th>SUBCATEGORY</th>
      <th>PRODUCT_NAME</th>
      <th>BRAND</th>
      <th>PRICE_RETAIL</th>
      <th>PRICE_CURRENT</th>
      <th>PRODUCT_SIZE</th>
      <th>PRICE_RESIDUAL</th>
      <th>LONGITUDE</th>
      <th>LATITUDE</th>
      <th>PREDICTION</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>247416</th>
      <td>23111</td>
      <td>Coffee</td>
      <td>Coffee Accessories</td>
      <td>Coffee Makers</td>
      <td>Ninja DualBrew Specialty Coffee System, Single...</td>
      <td>Ninja</td>
      <td>198.00</td>
      <td>198.00</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>37.613860</td>
      <td>-77.355548</td>
      <td>190.908431</td>
    </tr>
    <tr>
      <th>247346</th>
      <td>15601</td>
      <td>Coffee</td>
      <td>Coffee Accessories</td>
      <td>Coffee Makers</td>
      <td>Ninja DualBrew Specialty Coffee System, Single...</td>
      <td>Ninja</td>
      <td>198.00</td>
      <td>198.00</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>40.308622</td>
      <td>-79.580229</td>
      <td>190.909471</td>
    </tr>
    <tr>
      <th>246757</th>
      <td>48180</td>
      <td>Coffee</td>
      <td>Coffee Accessories</td>
      <td>Coffee Makers</td>
      <td>Ninja DualBrew Specialty Coffee System, Single...</td>
      <td>Ninja</td>
      <td>198.00</td>
      <td>198.00</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>42.253080</td>
      <td>-83.269870</td>
      <td>190.907174</td>
    </tr>
    <tr>
      <th>252858</th>
      <td>23223</td>
      <td>Coffee</td>
      <td>Coffee Accessories</td>
      <td>Coffee Makers</td>
      <td>Ninja DualBrew Specialty Coffee System, Single...</td>
      <td>Ninja</td>
      <td>198.00</td>
      <td>198.00</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>37.545799</td>
      <td>-77.364601</td>
      <td>190.908429</td>
    </tr>
    <tr>
      <th>64803</th>
      <td>77449</td>
      <td>Candy</td>
      <td>Gummy &amp; chewy candy</td>
      <td>NaN</td>
      <td>Hi Chew Original Mix Candy - 12.7 Oz</td>
      <td>Hi-Chew</td>
      <td>246.87</td>
      <td>246.87</td>
      <td>12.7</td>
      <td>0.0</td>
      <td>29.818740</td>
      <td>-95.767580</td>
      <td>237.765627</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-19c1b3ae-cb40-4f31-b7c9-870c9ace18ef')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-19c1b3ae-cb40-4f31-b7c9-870c9ace18ef button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-19c1b3ae-cb40-4f31-b7c9-870c9ace18ef');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="27" data-colab="{&quot;height&quot;:424,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="86G48ATxkftl" data-outputId="51847a7c-6d81-4323-b417-1a69164896a9">
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>residual_sort <span class="op">=</span> df.sort_values(<span class="st">&quot;PRICE_RESIDUAL&quot;</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>residual_sort.tail() <span class="co"># finding the very high residual</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="27">

  <div id="df-9a3aaa13-a0b0-4e1f-80ce-ecc460e98dfa">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SHIPPING_LOCATION</th>
      <th>DEPARTMENT</th>
      <th>CATEGORY</th>
      <th>SUBCATEGORY</th>
      <th>PRODUCT_NAME</th>
      <th>BRAND</th>
      <th>PRICE_RETAIL</th>
      <th>PRICE_CURRENT</th>
      <th>PRODUCT_SIZE</th>
      <th>PRICE_RESIDUAL</th>
      <th>LONGITUDE</th>
      <th>LATITUDE</th>
      <th>PREDICTION</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>404929</th>
      <td>44035</td>
      <td>Pantry</td>
      <td>Pasta &amp; pizza</td>
      <td>Shop all</td>
      <td>Lucini Italia Organic Tuscan Marinara Sauce 25...</td>
      <td>Lucini Italia</td>
      <td>131.07</td>
      <td>5.97</td>
      <td>25.5</td>
      <td>125.1</td>
      <td>41.350877</td>
      <td>-82.067282</td>
      <td>126.100990</td>
    </tr>
    <tr>
      <th>344874</th>
      <td>77449</td>
      <td>Pantry</td>
      <td>Pasta &amp; pizza</td>
      <td>Shop all</td>
      <td>Lucini Italia Organic Tuscan Marinara Sauce 25...</td>
      <td>Lucini Italia</td>
      <td>131.07</td>
      <td>5.97</td>
      <td>25.5</td>
      <td>125.1</td>
      <td>29.818740</td>
      <td>-95.767580</td>
      <td>126.102475</td>
    </tr>
    <tr>
      <th>362047</th>
      <td>15601</td>
      <td>Pantry</td>
      <td>Pasta &amp; pizza</td>
      <td>Shop all</td>
      <td>Lucini Italia Organic Tuscan Marinara Sauce 25...</td>
      <td>Lucini Italia</td>
      <td>131.07</td>
      <td>5.97</td>
      <td>25.5</td>
      <td>125.1</td>
      <td>40.308622</td>
      <td>-79.580229</td>
      <td>126.103125</td>
    </tr>
    <tr>
      <th>380419</th>
      <td>23223</td>
      <td>Pantry</td>
      <td>Pasta &amp; pizza</td>
      <td>Shop all</td>
      <td>Lucini Italia Organic Tuscan Marinara Sauce 25...</td>
      <td>Lucini Italia</td>
      <td>131.07</td>
      <td>5.97</td>
      <td>25.5</td>
      <td>125.1</td>
      <td>37.545799</td>
      <td>-77.364601</td>
      <td>126.102083</td>
    </tr>
    <tr>
      <th>515021</th>
      <td>63376</td>
      <td>Pantry</td>
      <td>Pasta &amp; pizza</td>
      <td>Shop all</td>
      <td>Lucini Italia Organic Tuscan Marinara Sauce 25...</td>
      <td>Lucini Italia</td>
      <td>131.07</td>
      <td>5.97</td>
      <td>25.5</td>
      <td>125.1</td>
      <td>38.744946</td>
      <td>-90.588537</td>
      <td>126.101627</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9a3aaa13-a0b0-4e1f-80ce-ecc460e98dfa')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9a3aaa13-a0b0-4e1f-80ce-ecc460e98dfa button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9a3aaa13-a0b0-4e1f-80ce-ecc460e98dfa');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell markdown" id="dnHzpqTuXfqf">
<p>###Test the model</p>
</div>
<div class="cell code" data-execution_count="28" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="-nnF0UCjQDQ0" data-outputId="e651d9af-19a5-435a-d51d-eb146b41d0b0">
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split test and train data for validation</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(data_copy, y_copy, test_size<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>reg <span class="op">=</span> linear_model.Ridge(alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>reg.fit(X_train, y_train)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># R2 score</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>reg.score(dummies, df[<span class="st">&quot;PRICE_CURRENT&quot;</span>])</span></code></pre></div>
<div class="output execute_result" data-execution_count="28">
<pre><code>0.9798174488888517</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="29" data-colab="{&quot;height&quot;:334,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="5v0KddNKYqZE" data-outputId="c7690b02-013e-41d0-f79c-779e0365497d">
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>data_copy[<span class="st">&quot;PREDICTION&quot;</span>] <span class="op">=</span> reg.predict(dummies)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>data_copy.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="29">

  <div id="df-7455a218-3703-4ebe-8532-94ab03c406c0">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SHIPPING_LOCATION</th>
      <th>PRICE_RETAIL</th>
      <th>PRODUCT_SIZE</th>
      <th>LONGITUDE</th>
      <th>LATITUDE</th>
      <th>CATEGORY_Bacon, Hot Dogs, Sausage</th>
      <th>CATEGORY_Baking Nuts &amp; Seeds</th>
      <th>CATEGORY_Baking Soda &amp; Starch</th>
      <th>CATEGORY_Beef Jerky</th>
      <th>CATEGORY_Beer</th>
      <th>...</th>
      <th>DEPARTMENT_Candy</th>
      <th>DEPARTMENT_Coffee</th>
      <th>DEPARTMENT_Dairy &amp; Eggs</th>
      <th>DEPARTMENT_Deli</th>
      <th>DEPARTMENT_Fresh Produce</th>
      <th>DEPARTMENT_Frozen</th>
      <th>DEPARTMENT_Meat &amp; Seafood</th>
      <th>DEPARTMENT_Pantry</th>
      <th>DEPARTMENT_Snacks</th>
      <th>PREDICTION</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>79936</td>
      <td>2.67</td>
      <td>10.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2.720022</td>
    </tr>
    <tr>
      <th>1</th>
      <td>79936</td>
      <td>2.67</td>
      <td>10.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2.720022</td>
    </tr>
    <tr>
      <th>2</th>
      <td>79936</td>
      <td>2.67</td>
      <td>10.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2.720022</td>
    </tr>
    <tr>
      <th>3</th>
      <td>79936</td>
      <td>2.67</td>
      <td>10.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2.720022</td>
    </tr>
    <tr>
      <th>4</th>
      <td>79936</td>
      <td>3.12</td>
      <td>12.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3.153375</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 134 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7455a218-3703-4ebe-8532-94ab03c406c0')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-7455a218-3703-4ebe-8532-94ab03c406c0 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-7455a218-3703-4ebe-8532-94ab03c406c0');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="30" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="1ezyuu3Glnmu" data-outputId="a9556249-58bd-4d10-ea56-0ab11cba7d9b">
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>train_diff <span class="op">=</span> reg.predict(X_train) <span class="op">-</span> y_train</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>test_diff <span class="op">=</span> reg.predict(X_test) <span class="op">-</span> y_test</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;With 80/20 split:&#39;</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Average Training error: </span><span class="sc">{np.</span>mean(train_diff)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Average Testing error: </span><span class="sc">{np.</span>mean(test_diff)<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>With 80/20 split:
Average Training error: -4.2031997346349864e-16
Average Testing error: -8.193788675622636e-05
</code></pre>
</div>
</div>
<div class="cell markdown" id="qSxDd6sBn3QB">
<p>Overfitting to training data? Still successful on test data?</p>
</div>
<div class="cell code" data-execution_count="31" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="8S3jQLZfpV5x" data-outputId="d84da5eb-62ef-4c4e-c5e8-debf65d295cc">
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df.SHIPPING_LOCATION.unique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="31">
<pre><code>array([79936, 48180, 96797, 94565, 23223, 75211, 89108, 15601, 23111,
       33012, 72034, 60007, 63376, 44035, 53215, 33647,  6010, 66062,
       90650, 78130, 85225, 75052, 70072, 77449, 30044, 45011])</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="32" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="1lNmAizkJ9Jo" data-outputId="dc5a95e3-c0e9-4e27-90b5-ba0032636a92">
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>df.DEPARTMENT.unique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="32">
<pre><code>array([&#39;Deli&#39;, &#39;Beverages&#39;, &#39;Baking&#39;, &#39;Meat &amp; Seafood&#39;, &#39;Candy&#39;, &#39;Snacks&#39;,
       &#39;Dairy &amp; Eggs&#39;, &#39;Bakery &amp; Bread&#39;, &#39;Breakfast &amp; Cereal&#39;, &#39;Pantry&#39;,
       &#39;Coffee&#39;, &#39;Frozen&#39;, &#39;Fresh Produce&#39;, &#39;Alcohol&#39;], dtype=object)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="33" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="M7yu31BlJ4F7" data-outputId="7b2643b5-412e-47e6-b6dc-6a3ddcf784d7">
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df.CATEGORY.unique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="33">
<pre><code>array([&#39;Hummus, Dips, &amp; Salsa&#39;, &#39;Energy Drinks&#39;, &#39;Oils &amp; Shortening&#39;,
       &#39;Fresh Soups &amp; Salads&#39;, &#39;Game Time Faves&#39;, &#39;Sparkling Water&#39;,
       &#39;Better for you&#39;, &#39;Healthy Snacks&#39;, &#39;Pudding &amp; Gelatin&#39;,
       &#39;Pretzels&#39;, &#39;Granola Bars&#39;, &#39;Baking Nuts &amp; Seeds&#39;, &#39;Yeast&#39;, &#39;Milk&#39;,
       &#39;Cheese&#39;, &#39;Halloween candy&#39;, &#39;Canned &amp; Powdered Milks&#39;,
       &#39;Specialty Cheeses &amp; Meats&#39;, &#39;Bacon, Hot Dogs, Sausage&#39;,
       &#39;Variety Pack Snacks&#39;, &#39;Drink Mixes&#39;, &#39;Eggs&#39;,
       &#39;Orange Juice &amp; Chilled&#39;, &#39;Cream &amp; Creamers&#39;, &#39;Beverage Deals&#39;,
       &#39;Hard candy &amp; lollipops&#39;, &#39;Meat Sticks&#39;, &#39;Fruit Snacks&#39;,
       &#39;Chocolate&#39;, &#39;Fresh Pizza&#39;, &#39;Sugars &amp; Sweeteners&#39;, &#39;New Arrivals&#39;,
       &#39;Biscuits, Cookies, Doughs&#39;, &#39;Top baking brands&#39;, &#39;Mints&#39;,
       &#39;Prepared Meals &amp; Sides&#39;, &#39;Yogurt&#39;, &#39;Popcorn&#39;, &#39;Chips&#39;,
       &#39;Rotisserie Chicken&#39;, &#39;Juices&#39;, &#39;Deli Meat &amp; Cheese&#39;,
       &#39;Gummy &amp; chewy candy&#39;, &#39;Non-Alcoholic Mixers&#39;,
       &#39;Butter &amp; Margarine&#39;, &#39;Sports Drinks&#39;, &#39;Multipacks &amp; bags&#39;,
       &#39;Crackers&#39;, &#39;Fresh Pasta&#39;, &#39;Flours &amp; Meals&#39;, &#39;Easy to make&#39;,
       &#39;Snack Nuts&#39;, &#39;Snacks &amp; Fresh Sandwiches&#39;, &#39;Great Value Beverages&#39;,
       &#39;Sour Cream &amp; Chilled Dips&#39;, &quot;Kids&#39; Multi-Packs&quot;, &#39;Gum&#39;,
       &#39;Beef Jerky&#39;, &#39;Baking Soda &amp; Starch&#39;, &#39;Tea&#39;, &#39;Fresh Bakery Breads&#39;,
       &#39;Breakfast Meats&#39;, &#39;Breakfast Breads&#39;, &#39;Cookies &amp; Brownies&#39;,
       &#39;Grilling&#39;, &#39;Fresh Food&#39;, &#39;Rolls &amp; Buns&#39;, &#39;Cakes &amp; Cupcakes&#39;,
       &#39;Emergency &amp; Institutional food&#39;, &#39;Cereal &amp; Granola&#39;,
       &#39;Dairy &amp; Eggs&#39;, &#39;Breakfast Beverages&#39;, &#39;Coffee Accessories&#39;,
       &#39;Tortillas&#39;, &#39;Pies&#39;, &#39;Donuts, Muffins &amp; Pastries&#39;, &#39;Roast Type&#39;,
       &#39;Muffins &amp; Pastries&#39;, &#39;Sweet Treats&#39;, &#39;Sliced Bread&#39;,
       &#39;Pancakes, Waffles &amp; Syrups&#39;, &#39;Herbs, spices &amp; seasonings&#39;,
       &#39;Frozen Meals &amp; Snacks&#39;, &#39;Fresh Vegetables&#39;, &#39;Salad Kits &amp; Bowls&#39;,
       &#39;Frozen Potatoes&#39;, &#39;Organic Produce&#39;, &#39;Fresh Dressings&#39;,
       &#39;Condiments&#39;, &#39;Salsa &amp; Dips&#39;, &#39;Cooking oils &amp; vinegars&#39;,
       &#39;Plant-based Protein &amp; Tofu&#39;, &#39;Soup&#39;, &#39;Fresh Fruits&#39;,
       &#39;Frozen Meat &amp; Seafood&#39;, &#39;Frozen Desserts&#39;, &#39;Canned goods&#39;,
       &#39;Frozen Breakfast&#39;, &#39;Cut Fruits &amp; Vegetables&#39;, &#39;Pasta &amp; pizza&#39;,
       &#39;International foods&#39;, &#39;Coffee Additives&#39;, &#39;Fresh Herbs&#39;,
       &#39;Frozen Pizza, Pasta, &amp; Breads&#39;, &#39;Rice, grains &amp; dried beans&#39;,
       &#39;Frozen Produce&#39;, &#39;Coffee By Type&#39;, &#39;Canned vegetables&#39;,
       &#39;Hot Cereals&#39;, &#39;Packaged meals &amp; side dishes&#39;, &#39;Fresh Flowers&#39;,
       &#39;Wine&#39;, &#39;Spirits&#39;, &#39;Beer&#39;], dtype=object)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="34" data-colab="{&quot;height&quot;:337,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="McWiPMuIuoX6" data-outputId="5be3b911-4098-4e22-aa1c-ad7518656ee4">
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="34">

  <div id="df-f31ffeaa-11bc-4356-8133-2aad15e479b2">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SHIPPING_LOCATION</th>
      <th>DEPARTMENT</th>
      <th>CATEGORY</th>
      <th>SUBCATEGORY</th>
      <th>PRODUCT_NAME</th>
      <th>BRAND</th>
      <th>PRICE_RETAIL</th>
      <th>PRICE_CURRENT</th>
      <th>PRODUCT_SIZE</th>
      <th>PRICE_RESIDUAL</th>
      <th>LONGITUDE</th>
      <th>LATITUDE</th>
      <th>PREDICTION</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Marketside Roasted Red Pepper Hummus, 10 Oz</td>
      <td>Marketside</td>
      <td>2.67</td>
      <td>2.67</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>2.719601</td>
    </tr>
    <tr>
      <th>1</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Marketside Roasted Garlic Hummus, 10 Oz</td>
      <td>Marketside</td>
      <td>2.67</td>
      <td>2.67</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>2.719601</td>
    </tr>
    <tr>
      <th>2</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Marketside Classic Hummus, 10 Oz</td>
      <td>Marketside</td>
      <td>2.67</td>
      <td>2.67</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>2.719601</td>
    </tr>
    <tr>
      <th>3</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Marketside Everything Hummus, 10 oz</td>
      <td>Marketside</td>
      <td>2.67</td>
      <td>2.67</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>2.719601</td>
    </tr>
    <tr>
      <th>4</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Price's Jalapeno Dip, 12 Oz.</td>
      <td>Price's</td>
      <td>3.12</td>
      <td>3.12</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>3.153056</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f31ffeaa-11bc-4356-8133-2aad15e479b2')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f31ffeaa-11bc-4356-8133-2aad15e479b2 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f31ffeaa-11bc-4356-8133-2aad15e479b2');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="35" id="AUc6b1VPE2pK">
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># testing other products</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>test_list <span class="op">=</span> [[<span class="dv">23111</span>, <span class="st">&quot;Fresh Produce&quot;</span>, <span class="st">&quot;Fresh Fruit&quot;</span>, <span class="dv">1</span>], <span class="co"># strawberries 4.99 amazon / lb</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>            [<span class="dv">23111</span>, <span class="st">&quot;Dairy &amp; Eggs&quot;</span>, <span class="st">&quot;Cheese&quot;</span>, <span class="dv">8</span>], <span class="co"># shredded cheese 2.39, 8 oz amazon</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>            [<span class="dv">23111</span>, <span class="st">&quot;Dairy &amp; Eggs&quot;</span>, <span class="st">&quot;Cheese&quot;</span>, <span class="dv">8</span>], <span class="co"># shredded cheese 2.39, 8 oz amazon   </span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>            ]</span></code></pre></div>
</div>
<section id="bayesian-ridge-regression" class="cell markdown" id="N1G_JpEtd4pP">
<h1>Bayesian Ridge Regression</h1>
</section>
<div class="cell markdown" id="ohVtgdcWXOhF">
<p>###Fit the model</p>
</div>
<div class="cell code" data-execution_count="36" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="_ia-f3VUeIui" data-outputId="4ca93f30-70a7-499b-f9b1-d7191b4556ee">
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>bayReg <span class="op">=</span> linear_model.BayesianRidge()</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>bayReg.fit(X_train, y_train)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co">#bayReg.coef_</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="36">
<pre><code>BayesianRidge()</code></pre>
</div>
</div>
<div class="cell markdown" id="cH705zIUXP-E">
<p>###Test Bayes model</p>
</div>
<div class="cell code" data-execution_count="37" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="WGuxv1rQroyK" data-outputId="96adb93a-9a01-4bc1-eb85-1267d60c29b9">
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>train_diff <span class="op">=</span> bayReg.predict(X_train) <span class="op">-</span> y_train</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>test_diff <span class="op">=</span> bayReg.predict(X_test) <span class="op">-</span> y_test</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;With 80/20 split:&#39;</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Average Training error: </span><span class="sc">{np.</span>mean(train_diff)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Average Testing error: </span><span class="sc">{np.</span>mean(test_diff)<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>With 80/20 split:
Average Training error: -6.433332715362684e-17
Average Testing error: -7.85595229730112e-05
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="38" data-colab="{&quot;height&quot;:548,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="iBKvea2eCGV4" data-outputId="9c4483e0-df65-4578-88dc-f7033cd0ae87">
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;PREDICTION_BAYES&quot;</span>] <span class="op">=</span> bayReg.predict(dummies)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="38">

  <div id="df-fbd9dd6c-455c-4260-878a-ea6e81df5274">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SHIPPING_LOCATION</th>
      <th>DEPARTMENT</th>
      <th>CATEGORY</th>
      <th>SUBCATEGORY</th>
      <th>PRODUCT_NAME</th>
      <th>BRAND</th>
      <th>PRICE_RETAIL</th>
      <th>PRICE_CURRENT</th>
      <th>PRODUCT_SIZE</th>
      <th>PRICE_RESIDUAL</th>
      <th>LONGITUDE</th>
      <th>LATITUDE</th>
      <th>PREDICTION</th>
      <th>PREDICTION_BAYES</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Marketside Roasted Red Pepper Hummus, 10 Oz</td>
      <td>Marketside</td>
      <td>2.67</td>
      <td>2.67</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>2.719601</td>
      <td>2.720829</td>
    </tr>
    <tr>
      <th>1</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Marketside Roasted Garlic Hummus, 10 Oz</td>
      <td>Marketside</td>
      <td>2.67</td>
      <td>2.67</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>2.719601</td>
      <td>2.720829</td>
    </tr>
    <tr>
      <th>2</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Marketside Classic Hummus, 10 Oz</td>
      <td>Marketside</td>
      <td>2.67</td>
      <td>2.67</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>2.719601</td>
      <td>2.720829</td>
    </tr>
    <tr>
      <th>3</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Marketside Everything Hummus, 10 oz</td>
      <td>Marketside</td>
      <td>2.67</td>
      <td>2.67</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>2.719601</td>
      <td>2.720829</td>
    </tr>
    <tr>
      <th>4</th>
      <td>79936</td>
      <td>Deli</td>
      <td>Hummus, Dips, &amp; Salsa</td>
      <td>NaN</td>
      <td>Price's Jalapeno Dip, 12 Oz.</td>
      <td>Price's</td>
      <td>3.12</td>
      <td>3.12</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>3.153056</td>
      <td>3.154200</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-fbd9dd6c-455c-4260-878a-ea6e81df5274')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-fbd9dd6c-455c-4260-878a-ea6e81df5274 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-fbd9dd6c-455c-4260-878a-ea6e81df5274');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell markdown" id="R5b9oOoGXTmf">
<p>###Graph predictions by department</p>
</div>
<div class="cell code" data-execution_count="39" data-colab="{&quot;height&quot;:542,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="EXzd42-sBiZh" data-outputId="6941cb72-7c35-4a51-a5e3-4241e2840ef7">
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting predicted price by detp</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">7</span>))</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    sns.scatterplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, y<span class="op">=</span><span class="st">&quot;PREDICTION_BAYES&quot;</span>, hue<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, palette<span class="op">=</span><span class="st">&quot;mako&quot;</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Predicted Price By Department (Bayes)&quot;</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    frame1 <span class="op">=</span> plt.gca()</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    frame1.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    plt.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/5cea4a7783ef0f4b03b50df120c47f145624eddc.png" /></p>
</div>
</div>
<div class="cell markdown" id="BUusRXJzfzHM">
<p>###Graph residual</p>
</div>
<div class="cell code" data-execution_count="40" data-colab="{&quot;height&quot;:433,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="ktEzd3R8fyBc" data-outputId="acaf6828-9dd5-43f1-b64b-ca789b1fcae4">
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot difference between current price and predicted price</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">5</span>))</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    sns.violinplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, y<span class="op">=</span>(df[<span class="st">&quot;PRICE_CURRENT&quot;</span>] <span class="op">-</span> df[<span class="st">&quot;PREDICTION_BAYES&quot;</span>]),<span class="op">\</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>                hue<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, palette<span class="op">=</span><span class="st">&quot;mako&quot;</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    frame1 <span class="op">=</span> plt.gca()</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    frame1.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    plt.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Residual Price (Current vs Predicted) by Department (Bayes)&quot;</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/64c77103fec7839f835718f378f103f55992adcd.png" /></p>
</div>
</div>
<section id="neural-network" class="cell markdown" id="V7EKqFkqNy0c">
<h1>Neural Network</h1>
</section>
<section id="prepare-data" class="cell markdown" id="x1Z8tg8CX9ZE">
<h3>Prepare data</h3>
</section>
<div class="cell code" data-execution_count="41" id="JN81it88N0xr">
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>nnData <span class="op">=</span> df.drop([<span class="st">&#39;PRICE_RESIDUAL&#39;</span>,<span class="st">&#39;PREDICTION&#39;</span>,<span class="st">&#39;SUBCATEGORY&#39;</span>,<span class="st">&#39;PRODUCT_NAME&#39;</span>, <span class="st">&#39;SHIPPING_LOCATION&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>nnData <span class="op">=</span> nnData.drop([<span class="st">&#39;BRAND&#39;</span>], axis <span class="op">=</span> <span class="dv">1</span>) <span class="co"># Comment out if we want to keep </span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>nnData <span class="op">=</span> pd.get_dummies(nnData , columns<span class="op">=</span>[<span class="st">&quot;CATEGORY&quot;</span>,<span class="st">&#39;DEPARTMENT&#39;</span>]) </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> nnData[<span class="st">&#39;PRICE_RETAIL&#39;</span>]</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>nnData <span class="op">=</span> nnData.drop([<span class="st">&#39;PRICE_RETAIL&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="42" data-colab="{&quot;height&quot;:334,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Cr45KmIvOiEP" data-outputId="d3924d77-b39a-40b2-f369-75bd9c08393e">
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>nnData.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="42">

  <div id="df-20a5450a-85cb-4a32-9539-652279ea17a6">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PRICE_CURRENT</th>
      <th>PRODUCT_SIZE</th>
      <th>LONGITUDE</th>
      <th>LATITUDE</th>
      <th>PREDICTION_BAYES</th>
      <th>CATEGORY_Bacon, Hot Dogs, Sausage</th>
      <th>CATEGORY_Baking Nuts &amp; Seeds</th>
      <th>CATEGORY_Baking Soda &amp; Starch</th>
      <th>CATEGORY_Beef Jerky</th>
      <th>CATEGORY_Beer</th>
      <th>...</th>
      <th>DEPARTMENT_Breakfast &amp; Cereal</th>
      <th>DEPARTMENT_Candy</th>
      <th>DEPARTMENT_Coffee</th>
      <th>DEPARTMENT_Dairy &amp; Eggs</th>
      <th>DEPARTMENT_Deli</th>
      <th>DEPARTMENT_Fresh Produce</th>
      <th>DEPARTMENT_Frozen</th>
      <th>DEPARTMENT_Meat &amp; Seafood</th>
      <th>DEPARTMENT_Pantry</th>
      <th>DEPARTMENT_Snacks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.67</td>
      <td>10.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>2.720829</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.67</td>
      <td>10.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>2.720829</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.67</td>
      <td>10.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>2.720829</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.67</td>
      <td>10.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>2.720829</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.12</td>
      <td>12.0</td>
      <td>31.75679</td>
      <td>-106.2707</td>
      <td>3.154200</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 133 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-20a5450a-85cb-4a32-9539-652279ea17a6')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-20a5450a-85cb-4a32-9539-652279ea17a6 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-20a5450a-85cb-4a32-9539-652279ea17a6');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<section id="set-up-and-train-4-layer-neural-net-model" class="cell markdown" id="lsIZeiExYBpH">
<h3>Set up and train 4 layer Neural Net model</h3>
</section>
<div class="cell code" data-execution_count="43" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="na3d0yJMOo1C" data-outputId="0939cfc1-8b31-4c58-a83c-a16509edab78">
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>random.seed(<span class="dv">20</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(nnData, Y, test_size<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> tf.keras.models.Sequential([</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Normalization(axis<span class="op">=-</span><span class="dv">1</span>), <span class="co">#Normalization layer</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Flatten(input_shape<span class="op">=</span>(<span class="dv">129</span>,)), <span class="co"># Number of input features</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">64</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>),</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">64</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>),</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">1</span>)<span class="co"># Number of Output classes I believe</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">&#39;mean_absolute_error&#39;</span>,optimizer<span class="op">=</span>tf.keras.optimizers.Adam(<span class="fl">0.001</span>))</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>model.fit(x_train, y_train, epochs<span class="op">=</span><span class="dv">10</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch 1/10
13302/13302 [==============================] - 26s 2ms/step - loss: 0.1256
Epoch 2/10
13302/13302 [==============================] - 26s 2ms/step - loss: 0.0534
Epoch 3/10
13302/13302 [==============================] - 27s 2ms/step - loss: 0.0385
Epoch 4/10
13302/13302 [==============================] - 27s 2ms/step - loss: 0.0324
Epoch 5/10
13302/13302 [==============================] - 27s 2ms/step - loss: 0.0270
Epoch 6/10
13302/13302 [==============================] - 29s 2ms/step - loss: 0.0254
Epoch 7/10
13302/13302 [==============================] - 27s 2ms/step - loss: 0.0232
Epoch 8/10
13302/13302 [==============================] - 26s 2ms/step - loss: 0.0213
Epoch 9/10
13302/13302 [==============================] - 27s 2ms/step - loss: 0.0196
Epoch 10/10
13302/13302 [==============================] - 27s 2ms/step - loss: 0.0194
</code></pre>
</div>
<div class="output execute_result" data-execution_count="43">
<pre><code>&lt;keras.callbacks.History at 0x7f644f978100&gt;</code></pre>
</div>
</div>
<section id="test-model" class="cell markdown" id="IZPRFlHtYIov">
<h3>Test model</h3>
</section>
<div class="cell code" data-execution_count="44" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="UaJ4Bkl5Py-N" data-outputId="76bba502-9ecd-4208-fa46-a7d8c10b1d5a">
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test model</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> model.evaluate(x_test,  y_test)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>results2 <span class="op">=</span> model.evaluate(x_train, y_train)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Average Testing error: </span><span class="sc">{</span>results<span class="op">/</span><span class="bu">len</span>(x_test)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Average Training error: </span><span class="sc">{</span>results2<span class="op">/</span><span class="bu">len</span>(x_train)<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>3326/3326 [==============================] - 6s 2ms/step - loss: 0.0143
13302/13302 [==============================] - 19s 1ms/step - loss: 0.0143
Average Testing error: 1.3392691851533762e-07
Average Training error: 3.371037738176233e-08
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="45" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Jqw7A9F8qXyH" data-outputId="5a7fcb66-6460-4853-fbd9-f59c10536079">
<div class="sourceCode" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;PREDICTION_NN&#39;</span>] <span class="op">=</span> model.predict(nnData)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>16628/16628 [==============================] - 22s 1ms/step
</code></pre>
</div>
</div>
<section id="plot-predictions-by-department" class="cell markdown" id="5PR_CMGlYKwv">
<h3>Plot predictions by department</h3>
</section>
<div class="cell code" data-execution_count="46" data-colab="{&quot;height&quot;:542,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="r31aQ0K3Nq-B" data-outputId="e85d894f-59a5-4709-fa02-baed10b86059">
<div class="sourceCode" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting predicted price by detp</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">7</span>))</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    sns.scatterplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, y<span class="op">=</span><span class="st">&quot;PREDICTION_NN&quot;</span>, hue<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, palette<span class="op">=</span><span class="st">&quot;mako&quot;</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Predicted Price By Department (NN)&quot;</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    frame1 <span class="op">=</span> plt.gca()</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    frame1.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    plt.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/99b04d7f4e1fb693ed3f1c0bf56446918380dab5.png" /></p>
</div>
</div>
<section id="plot-predictions-residuals" class="cell markdown" id="UMYf011Jf-Vs">
<h3>Plot predictions Residuals</h3>
</section>
<div class="cell code" data-execution_count="47" data-colab="{&quot;height&quot;:433,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="VQFh-Tj-gBB_" data-outputId="72dc17ed-2c79-4117-80f9-6f5d7aaa7ebd">
<div class="sourceCode" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot difference between current price and predicted price</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph:</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">5</span>))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    sns.violinplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, y<span class="op">=</span>(df[<span class="st">&quot;PRICE_CURRENT&quot;</span>] <span class="op">-</span> df[<span class="st">&quot;PREDICTION_NN&quot;</span>]),<span class="op">\</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>                hue<span class="op">=</span><span class="st">&quot;DEPARTMENT&quot;</span>, palette<span class="op">=</span><span class="st">&quot;mako&quot;</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    frame1 <span class="op">=</span> plt.gca()</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    frame1.tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    plt.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Residual Price (Current vs Predicted) by Department (NN)&quot;</span>)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_1ff84d5ec4324bd0a09ad1fdd50b0635/9cee264b963de1985715dab36f7969f83f83720b.png" /></p>
</div>
</div>
</body>
</html>
